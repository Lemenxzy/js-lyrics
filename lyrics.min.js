!function(a,b){"use strict";"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?module.exports=b():a.Lyrics=b()}(this,function(){"use strict";var a=function(a){this.timestamp_offset=0,this.lyrics_all=void 0,this.meta_info=void 0,this.ID_TAGS=[{name:"artist",id:"ar"},{name:"album",id:"al"},{name:"title",id:"ti"},{name:"author",id:"au"},{name:"length",id:"length"},{name:"by",id:"by"},{name:"offset",id:"offset",handler:this.setTimestampOffset},{name:"createdBy",id:"re"},{name:"createdByVersion",id:"ve"}];for(var b=0;b<this.ID_TAGS.length;b++)this.ID_TAGS[b].re=new RegExp("\\["+this.ID_TAGS[b].id+":(.*)\\]$","g");a&&this.load(a)};return a.prototype={constructor:a,load:function(a){var b,c,d,e,f,g,h,i,j;for(this.lyrics_all=new Array,this.meta_info=new Object,this.timestamp_offset=0,b=String(a).split("\n"),c=0;c<b.length;c++)if(d=b[c].replace(/(^\s*)|(\s*$)/g,"")){for(e=!1,f=0;f<this.ID_TAGS.length;f++)g=this.ID_TAGS[f].re.exec(d),!g||g.length<2||(e=!0,h=g[1].replace(/(^\s*)|(\s*$)/g,""),this.meta_info[String(this.ID_TAGS[f].name)]="function"==typeof this.ID_TAGS[f].handler?this.ID_TAGS[f].handler.call(this,h):String(h));if(!e){for(i=Array();;){if(g=/^(\[\d+:\d+(.\d+)?\])(.*)/g.exec(d),!g)break;i.push(g[1]),d=g[g.length-1].replace(/(^\s*)|(\s*$)/g,"")}for(f=0;f<i.length;f++)j=/^\[(\d{1,2}):(\d|[0-5]\d)(\.(\d+))?\]$/g.exec(i[f]),j&&this.lyrics_all.push({timestamp:60*Number(j[1])+Number(j[2])+(j[4]?Number("0."+j[4]):0),text:d})}}return this.lyrics_all.sort(function(a,b){return a.timestamp>b.timestamp?1:-1}),this.lyrics_all.length||(this.lyrics_all=void 0),this.isEmpty(this.meta_info)&&(this.meta_info=void 0),void 0!==this.lyrics_all||void 0!==this.meta_info?!0:!1},getLyrics:function(){return this.lyrics_all},getLyric:function(a){try{return this.lyrics_all[a]}catch(b){return void 0}},getIDTags:function(){return this.meta_info},select:function(a){var b,c;if(isNaN(a))return-1;if(b=Number(a)+this.timestamp_offset,c=0,b<this.lyrics_all[0].timestamp)return-1;for(c=0;c<this.lyrics_all.length-1&&!(this.lyrics_all[c].timestamp<=b&&this.lyrics_all[c+1].timestamp>b);c++);return c},setTimestampOffset:function(a){return this.timestamp_offset=isNaN(a)?0:Number(a)/1e3,Number(a)},isEmpty:function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}},a});